<!DOCTYPE html>
<html>

<head>
	<title>Basestation ABC</title>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
	<style>
		.chartTemperature {
			width: 100%;
			height: 500px;
		}
	</style>
</head>

<body class="bg-dark">
	<header>
		<nav class="navbar navbar-expand-lg navbar-light bg-light">
			<a class="navbar-brand" href="#">Basestation TA</a>
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
				aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>

			<div class="collapse navbar-collapse" id="navbarSupportedContent">
				<ul class="navbar-nav mr-auto">
					<li class="nav-item active">
						<a class="nav-link" href="/">Home <span class="sr-only">(current)</span></a>
					</li>
				</ul>
			</div>
		</nav>
	</header>

	<div class="container">
		<div class="row my-5">

			<div class="col-6 col-sm-6 col-md-3 col-lg-3">
				<div class="card">
					<div class="card-body text-center">
						<h5 class="card-title">CPU Temp</h5>
						<h1 class="text-danger"><span id="valueCPUTemp">30</span><small>&#8451</small></h1>
					</div>
				</div>
			</div>

			<div class="col-6 col-sm-6 col-md-3 col-lg-3">
				<div class="card">
					<div class="card-body text-center">
						<h5 class="card-title">Memory Load</h5>
						<h1 class="text-success"><span id="valueMemoryLoad"></span><small>MB</small></h1>
					</div>
				</div>
			</div>

		</div>

		<div class="row">
			<div class="col-12">
				<div class="card">
					<div class="card-body">
						<div class="row">
							<div class="col">
								<h3>Temperature</h3>
								<div class="chartTemperature" width="100%"></div>
							</div>
						</div>

					</div>
				</div>
			</div>
		</div>

	</div>


	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
	<!-- Resources -->
	<script src="https://cdn.amcharts.com/lib/4/core.js"></script>
	<script src="https://cdn.amcharts.com/lib/4/charts.js"></script>
	<script src="https://cdn.amcharts.com/lib/4/themes/animated.js"></script>
	<script>
		const getStatusRaspi = () => {
			$.ajax({
				url: 'getStatus',
				success: (respond) => {
					$("#valueCPUTemp").text(respond.cpuTemp);
					$("#valueMemoryLoad").text(respond.memoryLoad);
				}
			})
		}

		getStatusRaspi();
		setInterval(() => {
			getStatusRaspi();
		}, 5000)

		am4core.ready(function () {

			// Themes begin
			am4core.useTheme(am4themes_animated);
			// Themes end

			var chart = am4core.create("chartTemperature", am4charts.XYChart);

			var data = [];
			var value = 50;
			for (var i = 0; i < 300; i++) {
				var date = new Date();
				date.setHours(0, 0, 0, 0);
				date.setDate(i);
				value -= Math.round((Math.random() < 0.5 ? 1 : -1) * Math.random() * 10);
				data.push({ date: date, value: value });
			}

			chart.data = data;

			// Create axes
			var dateAxis = chart.xAxes.push(new am4charts.DateAxis());
			dateAxis.renderer.minGridDistance = 60;

			var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());

			// Create series
			var series = chart.series.push(new am4charts.LineSeries());
			series.dataFields.valueY = "value";
			series.dataFields.dateX = "date";
			series.tooltipText = "{value}"

			series.tooltip.pointerOrientation = "vertical";

			chart.cursor = new am4charts.XYCursor();
			chart.cursor.snapToSeries = series;
			chart.cursor.xAxis = dateAxis;

			//chart.scrollbarY = new am4core.Scrollbar();
			chart.scrollbarX = new am4core.Scrollbar();

		});
		
	</script>
</body>

</html>